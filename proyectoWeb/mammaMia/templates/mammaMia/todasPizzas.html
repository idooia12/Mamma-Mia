{% extends 'mammaMia/base.html' %}

{% block title %}Todas las pizzas - Mamma Mia{% endblock %}

{% block subtitle %}Listado completo de nuestras pizzas{% endblock %}

{% block content %}
<div class="filtros-container">
    <form method="get">
        
        <!-- Filtro por masa -->
        <div class="filtro-seccion">
            <label for="masa" class="filtro-label">Filtrar por masa:</label>
            <select name="masa" id="masa" class="select-masa">
                <option value="">Todas</option>
                {% for masa in masas %}
                <option value="{{ masa.id }}" {% if masa_seleccionada == masa.id|stringformat:"s" %}selected{% endif %}>
                    {{ masa.nombre }}
                </option>
                {% endfor %}
            </select>
        </div>

        <!-- Filtro por ingredientes -->
        <div class="filtro-seccion ingredientes-grid">
            <span class="filtro-label">Filtrar por ingredientes:</span>
            <div class="grid-ingredientes">
                {% for ingrediente in ingredientes %}
                <label class="checkbox-ingrediente">
                    <input type="checkbox" name="ingredientes" value="{{ ingrediente.id }}"
                    {% if ingrediente.id in ingredientes_seleccionados %}checked{% endif %}>
                    {{ ingrediente.nombre }}
                </label>
                {% endfor %}
            </div>
        </div>

        <!-- Botones -->
        <div class="botones-filtro">
            <button type="submit" class="btn-buscar">Buscar</button>
            <a href="{% url 'todasLasPizzas' %}" class="btn-limpiar">Limpiar</a>
        </div>
    </form>
</div>

<div class="contenedor-pizzas">
    
    {% if pizzas %}
        {% for pizza in pizzas %}
        <div class="pizza">
            <div class="pizza-contenido">
                <div class="pizza-info">
                    <a href="{% url 'detallePizza' pizza.id %}" class="pizza-link"></a>
                        <h2>{{ pizza.nombre }}</h2>
                    </a>
                    <p><strong>Masa:</strong> {{ pizza.masa.nombre }}</p>
                    <p><strong>Precio:</strong> <span class="precio">{{ pizza.precio }} €</span></p>
                </div>

                <div class="pizza-imagen">
                    {% if pizza.imagen %}
                        <img src="{{ pizza.imagen.url }}" alt="{{ pizza.nombre }}">
                    {% else %}
                        <p>Sin imagen disponible</p>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    {% else %}
        <p>No hay pizzas registradas todavía.</p>
    {% endif %}
</div>
{% endblock %}