{% extends 'mammaMia/base.html' %}
{% load i18n %}

{% block title %}{% trans "Todas las pizzas" %} - Mamma Mia{% endblock %}
{% block subtitle %}{% trans "Listado completo de nuestras pizzas" %}{% endblock %}

{% block content %}

<!-- BUSCADOR INTERACTIVO (JS) -->
<div class="buscador-js-container" style="text-align: center; margin-bottom: 30px;">
    <input type="text" id="buscador-cliente" placeholder="üîç {% trans 'Buscar pizza r√°pidamente...' %}" 
           style="padding: 10px; width: 80%; max-width: 400px; border-radius: 20px; border: 2px solid #CD212A; outline: none;">
</div>

<div class="filtros-container">
    <form method="get">
        <!-- Filtro Masa -->
        <div class="filtro-seccion">
            <label for="masa" class="filtro-label">{% trans "Filtrar por masa:" %}</label>
            <select name="masa" id="masa" class="select-masa">
                <option value="">{% trans "Todas" %}</option>
                {% for masa in masas %}
                <option value="{{ masa.id }}" {% if masa_seleccionada == masa.id|stringformat:"s" %}selected{% endif %}>
                    {{ masa.nombre }}
                </option>
                {% endfor %}
            </select>
        </div>

        <!-- Filtro Ingredientes -->
        <div class="filtro-seccion ingredientes-grid">
            <span class="filtro-label">{% trans "Filtrar por ingredientes:" %}</span>
            <div class="grid-ingredientes">
                {% for ingrediente in ingredientes %}
                <label class="checkbox-ingrediente">
                    <input type="checkbox" name="ingredientes" value="{{ ingrediente.id }}"
                    {% if ingrediente.id in ingredientes_seleccionados %}checked{% endif %}>
                    {{ ingrediente.nombre }}
                </label>
                {% endfor %}
            </div>
        </div>

        <!-- Botones -->
        <div class="botones-filtro">
            <button type="submit" class="btn-buscar">{% trans "Buscar" %}</button>
            <!-- CORRECCI√ìN AQU√ç TAMBI√âN -->
            <a href="{% url 'todasLasPizzas' %}" class="btn-limpiar">{% trans "Limpiar" %}</a>
        </div>
    </form>
</div>

<div class="contenedor-pizzas">
    {% if pizzas %}
        {% for pizza in pizzas %}
        <div class="pizza">
            <div class="pizza-contenido">
                <div class="pizza-info">
                    <a href="{% url 'detallePizza' pizza.id %}" class="pizza-link">
                        <h2>{{ pizza.nombre }}</h2>
                    </a>
                    <p><strong>{% trans "Masa:" %}</strong> {{ pizza.masa.nombre }}</p>
                    <p><strong>{% trans "Precio:" %}</strong> <span class="precio">{{ pizza.precio }} ‚Ç¨</span></p>
                </div>
                <div class="pizza-imagen">
                    {% if pizza.imagen %}
                        <img src="{{ pizza.imagen.url }}" alt="{{ pizza.nombre }}">
                    {% else %}
                        <p>{% trans "Sin imagen disponible" %}</p>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    {% else %}
        <p>{% trans "No hay pizzas registradas todav√≠a." %}</p>
    {% endif %}
</div>
{% endblock %}